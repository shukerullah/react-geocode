{"version":3,"file":"index.es.js","sources":["../src/index.ts"],"sourcesContent":["/**\r\n * Enum defining possible request types for geocoding.\r\n */\r\nexport enum RequestType {\r\n  ADDRESS = \"address\", // Geocoding by address\r\n  LATLNG = \"latlng\", // Geocoding by latitude and longitude\r\n  PLACE_ID = \"place_id\", // Geocoding by place ID\r\n}\r\n\r\n/**\r\n * Enum defining possible output formats for geocoding.\r\n */\r\nexport enum OutputFormat {\r\n  XML = \"xml\", // Output format XML\r\n  JSON = \"json\", // Output format JSON\r\n}\r\n\r\n/**\r\n * The URL of the Google Geocoding API.\r\n */\r\nconst GOOGLE_GEOCODE_API = \"https://maps.googleapis.com/maps/api/geocode\";\r\n\r\n/**\r\n * Options that can be passed to the geocoding requests.\r\n */\r\nexport interface GeocodeOptions {\r\n  key?: string; // API key for the Google Maps Geocoding API.\r\n  language?: string; // Language code for the response.\r\n  region?: string; // Region code for the response.\r\n  components?: string; // Component filtering for the response.\r\n  bounds?: string; // Bounding box for the response.\r\n  result_type?: string; // Result type filtering for the response.\r\n  location_type?: string; // Location type filtering for the response.\r\n  outputFormat: OutputFormat; // Desired output format (either XML or JSON)\r\n  enable_address_descriptor?: boolean; // Whether to include an address descriptor in the reverse geocoding response.\r\n}\r\n\r\n/**\r\n * Response object from the geocoding API.\r\n */\r\ninterface GeocodeResponse {\r\n  status: string;\r\n  results: GeocodeResult[];\r\n  address_descriptor?: AddressDescriptor;\r\n  plus_code?: PlusCode;\r\n  error_message?: string;\r\n}\r\n\r\n/**\r\n * The query parameters for geocoding requests.\r\n */\r\ninterface GeocodeQueryParams extends GeocodeOptions {\r\n  place_id?: string; // The plce id to geocode\r\n  address?: string; // The address to geocode\r\n  latlng?: string; // The latitude/longitude of the location to geocode\r\n}\r\n\r\n/**\r\n * Default options for the geocoding requests.\r\n */\r\nlet defaultOptions: GeocodeOptions = {\r\n  outputFormat: OutputFormat.JSON,\r\n};\r\n\r\n/**\r\n * Performs a geocoding request to the Google Geocoding API.\r\n * @function geocodeRequest\r\n * @async\r\n * @param {GeocodeQueryParams} queryParams - The query parameters for the geocoding request.\r\n * @returns {Promise<GeocodeResponse>} - A promise that resolves with the geocoding response object.\r\n * @throws {Error} - Throws an error if the geocoding request fails.\r\n */\r\nasync function geocodeRequest(\r\n  queryParams: GeocodeQueryParams\r\n): Promise<GeocodeResponse> {\r\n  const { outputFormat, ...restParams } = queryParams;\r\n  const queryString = new URLSearchParams(\r\n    restParams as Record<string, string>\r\n  ).toString();\r\n  const url = `${GOOGLE_GEOCODE_API}/${outputFormat}?${queryString}`;\r\n  try {\r\n    const response = await fetch(url);\r\n    const json = await response.json();\r\n    const { status, error_message } = json;\r\n\r\n    if (status === \"OK\") {\r\n      return json;\r\n    }\r\n\r\n    throw new Error(\r\n      `Geocoding failed: ${error_message}. Server returned status code ${status}.`\r\n    );\r\n  } catch (error: unknown) {\r\n    if (error instanceof Error) {\r\n      throw new Error(`Geocoding request failed: ${error.message}`);\r\n    }\r\n    throw new Error(`Geocoding request failed with unknown error: ${error}`);\r\n  }\r\n}\r\n\r\n/**\r\n * Sets default options for geocoding requests.\r\n *\r\n * @param options - The default options to set.\r\n */\r\nexport function setDefaults(options: GeocodeOptions): void {\r\n  defaultOptions = {\r\n    ...defaultOptions,\r\n    ...options,\r\n  };\r\n}\r\n\r\n/**\r\n * Sets the API key to use for geocoding requests.\r\n *\r\n * @param key - The API key to set.\r\n */\r\nexport function setKey(key: string): void {\r\n  defaultOptions.key = key;\r\n}\r\n\r\n/**\r\n * Sets the language to use for geocoding requests.\r\n *\r\n * @param language - The language to set.\r\n */\r\nexport function setLanguage(language: string): void {\r\n  defaultOptions.language = language;\r\n}\r\n\r\n/**\r\n * Sets the region code to use for geocoding requests.\r\n *\r\n * @param region - The region code to set.\r\n */\r\nexport function setRegion(region: string): void {\r\n  defaultOptions.region = region;\r\n}\r\n\r\n/**\r\n * Sets the component filter to use for geocoding requests.\r\n *\r\n * @param components - The component filter to set.\r\n */\r\nexport function setComponents(components: string): void {\r\n  defaultOptions.components = components;\r\n}\r\n\r\n/**\r\n * Sets the bounding box to use for geocoding requests.\r\n *\r\n * @param bounds - The bounding box to set.\r\n */\r\nexport function setBounds(bounds: string): void {\r\n  defaultOptions.bounds = bounds;\r\n}\r\n\r\n/**\r\n * Sets the result type filter to use for geocoding requests.\r\n * One or more address types to return, separated by a pipe (|).\r\n * Possible values are \"street_address\", \"route\", \"intersection\", \"political\", \"country\",\r\n * \"administrative_area_level_1\", \"administrative_area_level_2\", \"administrative_area_level_3\",\r\n * \"administrative_area_level_4\", \"administrative_area_level_5\", \"colloquial_area\", \"locality\",\r\n * \"ward\", \"sublocality\", \"neighborhood\", \"premise\", \"subpremise\", \"postal_code\", \"natural_feature\",\r\n * \"airport\", \"park\", \"point_of_interest\", and \"postal_code_prefix\".\r\n *\r\n * @param resultType - The result type to set.\r\n */\r\nexport function setResultType(resultType: string): void {\r\n  defaultOptions.result_type = resultType;\r\n}\r\n\r\n/**\r\n * Sets the location type filter to use for geocoding requests.\r\n * One or more location types to return. Possible values are \"ROOFTOP\",\r\n * \"RANGE_INTERPOLATED\", \"GEOMETRIC_CENTER\", \"APPROXIMATE\".\r\n *\r\n * @param locationType - The location type to set.\r\n */\r\nexport function setLocationType(locationType: string): void {\r\n  defaultOptions.location_type = locationType;\r\n}\r\n\r\n/**\r\n * Sets the desired output format for geocoding requests. The format can be either XML or JSON.\r\n *\r\n * @param outputFormat - The desired output format (either OutputFormat.XML or OutputFormat.JSON).\r\n */\r\nexport function setOutputFormat(outputFormat: OutputFormat): void {\r\n  defaultOptions.outputFormat = outputFormat;\r\n}\r\n\r\n/**\r\n * Sets whether to include an address descriptor in the reverse geocoding response.\r\n *\r\n * @param enableAddressDescriptor - A boolean parameter indicating whether to include the address descriptor.\r\n */\r\nexport function enableAddressDescriptor(\r\n  enableAddressDescriptor: boolean\r\n): void {\r\n  defaultOptions.enable_address_descriptor = enableAddressDescriptor;\r\n}\r\n\r\n/**\r\n * Sends a geocoding request to the Google Maps Geocoding API for a given address and returns the response.\r\n * @function geocode\r\n * @async\r\n * @param {RequestType} requestType - Identifier to specify the type of request (place_id, address, or latlng).\r\n * @param {string} value - The value to be used for geocoding (address, place_id, or latlng).\r\n * @param {GeocodeOptions} [options={}] - Additional options for the geocoding request.\r\n * @returns {Promise<GeocodeResponse>} - A promise that resolves with the geocoding response object.\r\n * @throws {Error} - Throws an error if the address is invalid or the geocoding request fails.\r\n */\r\nexport function geocode(\r\n  requestType: RequestType | string,\r\n  value: string,\r\n  options?: GeocodeOptions\r\n): Promise<any> {\r\n  if (typeof requestType !== \"string\" || typeof value !== \"string\") {\r\n    throw new Error(\r\n      `Both requestType and value are required and must be of type string. \r\n       requestType: ${typeof requestType}, value: ${typeof value}`\r\n    );\r\n  }\r\n\r\n  const queryParams: GeocodeQueryParams = {\r\n    ...defaultOptions,\r\n    ...options,\r\n    [requestType]: value,\r\n  };\r\n  return geocodeRequest(queryParams);\r\n}\r\n\r\n/**\r\n * @deprecated Use `geocode` instead.\r\n * Usage: geocode(\"address\", \"Washington\", *options)\r\n */\r\nexport function fromAddress(\r\n  address: string,\r\n  key?: string,\r\n  language?: string,\r\n  region?: string\r\n) {\r\n  const options: GeocodeOptions = {\r\n    outputFormat: OutputFormat.JSON,\r\n  };\r\n  if (key) {\r\n    options.key = key;\r\n  }\r\n  if (language) {\r\n    options.language = language;\r\n  }\r\n  if (region) {\r\n    options.region = region;\r\n  }\r\n  return geocode(RequestType.ADDRESS, address, options);\r\n}\r\n\r\n/**\r\n * @deprecated use `geocode` instead\r\n * Usage: geocode(\"place_id\", \"ChIJd8BlQ2BZwokRAFUEcm_qrcA\", *options)\r\n */\r\nexport function fromPlaceId(\r\n  placeId: string,\r\n  key?: string,\r\n  language?: string,\r\n  region?: string\r\n) {\r\n  const options: GeocodeOptions = {\r\n    outputFormat: OutputFormat.JSON,\r\n  };\r\n  if (key) {\r\n    options.key = key;\r\n  }\r\n  if (language) {\r\n    options.language = language;\r\n  }\r\n  if (region) {\r\n    options.region = region;\r\n  }\r\n  return geocode(RequestType.PLACE_ID, placeId, options);\r\n}\r\n\r\n/**\r\n * @deprecated use `geocode` instead\r\n * Usage: geocode(\"latlng\", \"40.714224,-73.961452\", *options)\r\n */\r\nexport function fromLatLng(\r\n  lat: number,\r\n  lng: number,\r\n  key?: string,\r\n  language?: string,\r\n  region?: string,\r\n  location_type?: string\r\n) {\r\n  const options: GeocodeOptions = {\r\n    outputFormat: OutputFormat.JSON,\r\n  };\r\n  if (key) {\r\n    options.key = key;\r\n  }\r\n  if (language) {\r\n    options.language = language;\r\n  }\r\n  if (region) {\r\n    options.region = region;\r\n  }\r\n  if (location_type) {\r\n    options.location_type = location_type;\r\n  }\r\n  return geocode(RequestType.LATLNG, `${lat},${lng}`, options);\r\n}\r\n\r\ninterface GeocodeResult {\r\n  address_components: AddressComponent[];\r\n  formatted_address: string;\r\n  geometry: Geometry;\r\n  place_id: string;\r\n  plus_code: PlusCode;\r\n  types: string[];\r\n}\r\n\r\ninterface AddressComponent {\r\n  long_name: string;\r\n  short_name: string;\r\n  types: string[];\r\n}\r\n\r\ninterface Geometry {\r\n  location: {\r\n    lat: number;\r\n    lng: number;\r\n  };\r\n  location_type: string;\r\n  viewport: {\r\n    lat: number;\r\n    lng: number;\r\n  };\r\n  southwest: {\r\n    lat: number;\r\n    lng: number;\r\n  };\r\n}\r\n\r\ninterface AddressDescriptor {\r\n  area: AreaDescriptor[];\r\n  landmarks: Landmark[];\r\n}\r\n\r\ninterface AreaDescriptor {\r\n  containment: string;\r\n  display_name: {\r\n    language_code: string;\r\n    text: string;\r\n  };\r\n  place_id: string;\r\n}\r\n\r\ninterface Landmark {\r\n  display_name: {\r\n    language_code: string;\r\n    text: string;\r\n  };\r\n  straight_line_distance_meters: number;\r\n  place_id: string;\r\n  travel_distance_meters: number;\r\n  spatial_relationship: string;\r\n  types: string[];\r\n}\r\n\r\ninterface PlusCode {\r\n  compound_code: string;\r\n  global_code: string;\r\n}\r\n"],"names":["RequestType","OutputFormat","GOOGLE_GEOCODE_API","defaultOptions","geocodeRequest","queryParams","outputFormat","restParams","queryString","url","json","status","error_message","error","setDefaults","options","setKey","key","setLanguage","language","setRegion","region","setComponents","components","setBounds","bounds","setResultType","resultType","setLocationType","locationType","setOutputFormat","enableAddressDescriptor","geocode","requestType","value","fromAddress","address","fromPlaceId","placeId","fromLatLng","lat","lng","location_type"],"mappings":"AAGY,IAAAA,sBAAAA,OACVA,EAAA,UAAU,WACVA,EAAA,SAAS,UACTA,EAAA,WAAW,YAHDA,IAAAA,KAAA,CAAA,CAAA,GASAC,sBAAAA,OACVA,EAAA,MAAM,OACNA,EAAA,OAAO,QAFGA,IAAAA,KAAA,CAAA,CAAA;AAQZ,MAAMC,IAAqB;AAwC3B,IAAIC,IAAiC;AAAA,EACnC,cAAc;AAAA;AAChB;AAUA,eAAeC,EACbC,GAC0B;AAC1B,QAAM,EAAE,cAAAC,GAAc,GAAGC,EAAA,IAAeF,GAClCG,IAAc,IAAI;AAAA,IACtBD;AAAA,IACA,SAAS,GACLE,IAAM,GAAGP,CAAkB,IAAII,CAAY,IAAIE,CAAW;AAC5D,MAAA;AAEI,UAAAE,IAAO,OADI,MAAM,MAAMD,CAAG,GACJ,QACtB,EAAE,QAAAE,GAAQ,eAAAC,EAAkB,IAAAF;AAElC,QAAIC,MAAW;AACN,aAAAD;AAGT,UAAM,IAAI;AAAA,MACR,qBAAqBE,CAAa,iCAAiCD,CAAM;AAAA,IAAA;AAAA,WAEpEE,GAAgB;AACvB,UAAIA,aAAiB,QACb,IAAI,MAAM,6BAA6BA,EAAM,OAAO,EAAE,IAExD,IAAI,MAAM,gDAAgDA,CAAK,EAAE;AAAA,EACzE;AACF;AAOO,SAASC,EAAYC,GAA+B;AACxC,EAAAZ,IAAA;AAAA,IACf,GAAGA;AAAA,IACH,GAAGY;AAAA,EAAA;AAEP;AAOO,SAASC,EAAOC,GAAmB;AACxC,EAAAd,EAAe,MAAMc;AACvB;AAOO,SAASC,EAAYC,GAAwB;AAClD,EAAAhB,EAAe,WAAWgB;AAC5B;AAOO,SAASC,EAAUC,GAAsB;AAC9C,EAAAlB,EAAe,SAASkB;AAC1B;AAOO,SAASC,EAAcC,GAA0B;AACtD,EAAApB,EAAe,aAAaoB;AAC9B;AAOO,SAASC,EAAUC,GAAsB;AAC9C,EAAAtB,EAAe,SAASsB;AAC1B;AAaO,SAASC,EAAcC,GAA0B;AACtD,EAAAxB,EAAe,cAAcwB;AAC/B;AASO,SAASC,EAAgBC,GAA4B;AAC1D,EAAA1B,EAAe,gBAAgB0B;AACjC;AAOO,SAASC,EAAgBxB,GAAkC;AAChE,EAAAH,EAAe,eAAeG;AAChC;AAOO,SAASyB,EACdA,GACM;AACN,EAAA5B,EAAe,4BAA4B4B;AAC7C;AAYgB,SAAAC,EACdC,GACAC,GACAnB,GACc;AACd,MAAI,OAAOkB,KAAgB,YAAY,OAAOC,KAAU;AACtD,UAAM,IAAI;AAAA,MACR;AAAA,sBACgB,OAAOD,CAAW,YAAY,OAAOC,CAAK;AAAA,IAAA;AAI9D,QAAM7B,IAAkC;AAAA,IACtC,GAAGF;AAAA,IACH,GAAGY;AAAA,IACH,CAACkB,CAAW,GAAGC;AAAA,EAAA;AAEjB,SAAO9B,EAAeC,CAAW;AACnC;AAMO,SAAS8B,EACdC,GACAnB,GACAE,GACAE,GACA;AACA,QAAMN,IAA0B;AAAA,IAC9B,cAAc;AAAA;AAAA,EAAA;AAEhB,SAAIE,MACFF,EAAQ,MAAME,IAEZE,MACFJ,EAAQ,WAAWI,IAEjBE,MACFN,EAAQ,SAASM,IAEZW,EAAQ,WAAqBI,GAASrB,CAAO;AACtD;AAMO,SAASsB,EACdC,GACArB,GACAE,GACAE,GACA;AACA,QAAMN,IAA0B;AAAA,IAC9B,cAAc;AAAA;AAAA,EAAA;AAEhB,SAAIE,MACFF,EAAQ,MAAME,IAEZE,MACFJ,EAAQ,WAAWI,IAEjBE,MACFN,EAAQ,SAASM,IAEZW,EAAQ,YAAsBM,GAASvB,CAAO;AACvD;AAMO,SAASwB,EACdC,GACAC,GACAxB,GACAE,GACAE,GACAqB,GACA;AACA,QAAM3B,IAA0B;AAAA,IAC9B,cAAc;AAAA;AAAA,EAAA;AAEhB,SAAIE,MACFF,EAAQ,MAAME,IAEZE,MACFJ,EAAQ,WAAWI,IAEjBE,MACFN,EAAQ,SAASM,IAEfqB,MACF3B,EAAQ,gBAAgB2B,IAEnBV,EAAQ,UAAoB,GAAGQ,CAAG,IAAIC,CAAG,IAAI1B,CAAO;AAC7D;"}